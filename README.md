# üìù –û—Ç—á–µ—Ç –ø–æ –∏—Ç–æ–≥–æ–≤–æ–º—É –∑–∞–¥–∞–Ω–∏—é ETL (4 –º–æ–¥—É–ª—å)

## üì¶ –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:** `transactions_v2.csv` (Object Storage Yandex Cloud).
- **ETL-–ø–∞–π–ø–ª–∞–π–Ω:** Airflow ‚Üí Dataproc (PySpark).
- **–§–æ—Ä–º–∞—Ç—ã:** CSV ‚Üí Parquet.
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ß–∏—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Parquet –≤ Object Storage.

---

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–∞–π–ø–ª–∞–π–Ω–∞

### 1. üîÑÔ∏è –†–∞–±–æ—Ç–∞ —Å Yandex DataTransfer

- –í—Ä—É—á–Ω—É—é —Å–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –≤ YDB –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
- –î–∞—Ç–∞—Å–µ—Ç `transactions_v2.csv` –∑–∞–≥—Ä—É–∂–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü—É —Å –ø–æ–º–æ—â—å—é CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.
- –ù–∞—Å—Ç—Ä–æ–µ–Ω —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä: –∏—Å—Ç–æ—á–Ω–∏–∫ ‚Äî YDB, –ø—Ä–∏–µ–º–Ω–∏–∫ ‚Äî Object Storage .
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–Ω–æ—Å–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –ª–æ–≥–æ–≤.

---

### 2. üñ•Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å Yandex Data Processing –∏ Airflow

- –†–∞–∑–≤–µ—Ä–Ω—É—Ç Managed Service for Airflow –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞.
- –°–æ–∑–¥–∞–Ω DAG `DATA_INGEST`, –∫–æ—Ç–æ—Ä—ã–π:
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä Dataproc.
  - –ó–∞–ø—É—Å–∫–∞–µ—Ç PySpark-–∑–∞–¥–∞–Ω–∏–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
  - –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —É–¥–∞–ª—è–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä.
- –í–Ω—É—Ç—Ä–∏ PySpark-—Å–∫—Ä–∏–ø—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
  - –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –≤—Å–µ—Ö –ø–æ–ª–µ–π (Integer, Boolean, Date, String).
  - –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å –ø—É—Å—Ç—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.
  - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞—Ç –∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ `yyyyMMdd` –≤ —Ç–∏–ø Date.
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Parquet: `s3a://etl-data-transform/transactions_v2_clean.parquet`.
- –í—Å–µ —ç—Ç–∞–ø—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã –ª–æ–≥–∞–º–∏ –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –∏–∑ YDB –≤ Object Storage.
- –û—á–∏—â–µ–Ω—ã –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ Parquet —Å –ø–æ–º–æ—â—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞.
- –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã, DAG –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.

---
